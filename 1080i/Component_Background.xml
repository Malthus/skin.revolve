<?xml version="1.0" encoding="UTF-8"?>
<includes>
    <expression name="HasVideoInBackground">Player.HasVideo + Skin.HasSetting(Background.Video.Active) + !SlideShow.IsActive</expression>
    <expression name="HasVisualizationInBackground">Player.HasAudio + Visualisation.Enabled + [[Skin.HasSetting(Background.Visualiser.Active) + !SlideShow.IsActive] | Skin.HasSetting(Background.Visualiser.RunHidden)]</expression>
    <expression name="HasImageInBackground">!Player.HasMedia | [!$EXP[HasVideoInBackground] + !$EXP[HasVisualizationInBackground]]</expression>

    <include name="GlobalBackground">
        <definition>
            <include content="VideoBackground" />
            <include content="MusicVisualizationBackground" />
            <include content="DefaultBackground" />
            <include content="ImageBackground" />
        </definition>
    </include>

    <include name="EmptyBackground">
        <definition>
            <control type="image">
                <include content="FullscreenDimensions" />
                <texture>black.png</texture>
            </control>
        </definition>
    </include>
    
    <include name="DefaultBackground">
        <definition>
            <control type="image">
                <visible>$EXP[HasImageInBackground]</visible>

                <include content="FullscreenDimensions" />
                <texture colordiffuse="$VAR[BackgroundColor]">white.png</texture>
            </control>
        </definition>
    </include>

    <include name="ImageBackground">
        <definition>
            <control type="group">
                <visible>$EXP[HasImageInBackground] + Skin.HasSetting(Background.Image.Active)</visible>

                <control type="image">
                    <include content="FadeAnimationForBackground" />
                    <include content="FullscreenDimensions" />
                    <fadetime>WindowFadeDuration</fadetime>
                    <texture background="true" fallback="special://skin/backgrounds/default.jpg">$VAR[ContentSingleImageBackground]</texture>
                    <aspectratio scalediffuse="false">scale</aspectratio>
                </control>

                <control type="multiimage">
                    <include content="FadeAnimationForBackground" />
                    <include content="FullscreenDimensions" />
                    <timeperimage>8000</timeperimage>
                    <randomize>true</randomize>
                    <fadetime>WindowFadeDuration</fadetime>
                    <imagepath background="true">$VAR[ContentMultiImageBackground]</imagepath>
                    <aspectratio scalediffuse="false">scale</aspectratio>
                </control>

                <control type="image">
                    <visible>Skin.HasSetting(Background.Image.Faded)</visible>
                    <include content="FadeAnimationForBackground" />
                    <include content="FullscreenDimensions" />
                    <fadetime>WindowFadeDuration</fadetime>
                    <texture colordiffuse="$VAR[FademaskColor]">white.png</texture>
                </control>
        </control>
        </definition>
    </include>

    <include name="MusicVisualizationBackground">
        <definition>
            <control type="group">
                <visible>$EXP[HasVisualizationInBackground]</visible>

                <control type="visualisation">
                    <include content="FullscreenDimensions" />
                </control>
            
                <control type="image">
                    <visible>Skin.HasSetting(Background.Visualiser.Faded)</visible>
                    <include content="FullscreenDimensions" />
                    <fadetime>WindowFadeDuration</fadetime>
                    <texture colordiffuse="$VAR[FademaskColor]">white.png</texture>
                </control>
            </control>
        </definition>
    </include>

    <include name="VideoBackground">
        <definition>
            <control type="group">
                <visible>$EXP[HasVideoInBackground]</visible>

                <control type="videowindow">
                    <include content="FullscreenDimensions" />
                </control>
            
                <control type="image">
                    <visible>Skin.HasSetting(Background.Video.Faded)</visible>
                    <include content="FullscreenDimensions" />
                    <fadetime>WindowFadeDuration</fadetime>
                    <texture colordiffuse="$VAR[FademaskColor]">white.png</texture>
                </control>
            </control>
        </definition>
    </include>

    <include name="FadeAnimationForBackground">
        <definition>
            <animation effect="fade" start="0" end="100" time="WindowFadeDuration">WindowOpen</animation>
            <animation effect="fade" start="0" end="100" time="WindowFadeDuration">Visible</animation>
            <animation effect="fade" start="100" end="0" time="WindowFadeDuration">Hidden</animation>
            <animation effect="fade" start="100" end="0" time="WindowFadeDuration">WindowClose</animation>
        </definition>
    </include>
</includes>
